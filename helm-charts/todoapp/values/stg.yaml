todoapp:
  environment: "staging"
  namespace: "todoapp-staging"
  createNamespace: true
  image:
    repository: "ikulyk404/todoapp"
    tag: ""  # Будет переопределяться в workflow
    pullPolicy: "IfNotPresent"

  service:
    type: "NodePort"
    ports:
      - name: "http"
        port: 80
        targetPort: 8080
        nodePort: 30008
        protocol: "TCP"

mysql:
  enabled: true
  environment: "staging"
  namespace: "mysql-staging"
  createNamespace: true

  image:
    repository: "mysql"
    tag: "8.0"
    pullPolicy: "IfNotPresent"

  resources:
    requests:
      memory: "256Mi"
      cpu: "300m"
      storage: "1Gi"  # Добавлено для volumeClaimTemplate
    limits:
      memory: "256Mi"
      cpu: "300m"

  hpa:
    enabled: true  # Явное включение
    minReplicas: 2
    maxReplicas: 5
    metrics:
      - type: "Resource"
        resource:
          name: "cpu"
          target:
            type: "Utilization"
            averageUtilization: 70  # Исправлено avarage -> average
      - type: "Resource"
        resource:
          name: "memory"
          target:
            type: "Utilization"
            averageUtilization: 70

  persistence:
    enabled: true
    size: "1Gi"
    accessModes: ["ReadWriteOnce"]